# Docker Compose untuk Node 2 (Server 2)
# Jalankan di server kedua: docker-compose -f docker-compose-node2.yml up -d

version: "3.8"
services:
    validator2:
        build:
            context: .
            dockerfile: backend/chain/Dockerfile
        image: evote-validator2:latest
        container_name: evote-validator-2
        volumes:
            - ./data/node2:/root/.cometbft/config
            - validator2_data:/root/.cometbft/data
            - ./scripts/entrypoint-node.sh:/entrypoint.sh:ro
        ports:
            - "26667:26657" # RPC (port berbeda)
            - "26666:26656" # P2P (port berbeda)
            - "26668:26658" # ABCI (port berbeda)
        networks:
            - evote-net
        entrypoint: ["/bin/sh", "/entrypoint.sh"]
        environment:
            - HOME_DIR=/root/.cometbft
            - MONIKER=validator2
            - EXTERNAL_IP=${EXTERNAL_IP:-localhost}
        restart: unless-stopped

volumes:
    validator2_data:

networks:
    evote-net:
        driver: bridge
